#!/bin/bash

[[ -z $1 ]] && exit 1

find_sorted_excl_nonsense() {
    find "$1/" -type f | sort |
    grep -vi .DS_Store |
    grep -vi .AppleDouble |
    grep -vi .LSOverride |
    grep -vi desktop.ini |
    grep -vi Thumbs.db |
    grep -vi ehthumbs.db |
    grep -vi Desktop.ini |
    grep -vi "\$RECYCLE.BIN" |
    grep -v -E '/\.'
}

files=$(find_sorted_excl_nonsense "$1")
if [[ -z "$files" ]]; then
    exit 0
fi

echo "$files" | grep -iE '\.(jpe?g|png)$' | tr '\n' '\0' | xargs -0 omxiv -t 5 -b
